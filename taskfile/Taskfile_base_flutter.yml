version: '3'

#
# global vars: https://taskfile.dev/#/usage?id=variables
#
vars:
  VAR1: "some-var"

# global env:
env:
  ENV1: testing


################################################################################################


# task groups:
tasks:
  default:
    cmds:
      - task: init
      - task: run

  install:
    cmds:
      - brew install fvm
      - fvm install 2.5.1
      - fvm list

  init:
    cmds:
      - fvm use 2.5.1 --force

  new:
    desc: "create flutter app"
    cmds:
      - echo "$(pwd) > ${FLUTTER_APP_ROOT} > ${FLUTTER_APP_NAME}"
      - task: do
        vars: {CMD: "create ${FLUTTER_APP_NAME}"}


  get:
    cmds:
      - task: do
        vars: {CMD: "pub get"}

  run:
    cmds:
      - task: do
        vars: {CMD: "run --debug"}

  run:ios:
    cmds:
      - task: do
        vars: {CMD: "run --debug -d ${FLUTTER_DEVICE_ID_IOS}"}

  run:android:
    cmds:
      - task: do
        vars: {CMD: "run --debug -d ${FLUTTER_DEVICE_ID_ANDROID}"}

  run:web:
    cmds:
      - task: do
        vars: {CMD: "run --debug -d chrome"}

  build:web:
    cmds:
      - task: do
        vars: {CMD: "build web"}

  do:
    cmds:
      - echo "$(pwd)/${FLUTTER_APP_ROOT}/${FLUTTER_APP_NAME}"
      - cd ${FLUTTER_APP_ROOT}/${FLUTTER_APP_NAME}; fvm flutter {{.CMD}}   # DO CMD

